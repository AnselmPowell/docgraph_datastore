""
the_weather/weather/views.py
from django.shortcuts import render
import requests
from .models import City
the_weather/weather/views.py
...
def index(request):
url = 'http://api.openweathermap.org/data/2.5/weather?q={}&units=imperial&ap-
pid=YOUR_APP_KEY'
cities = City.objects.all()
...
""
"Since we have the cities, we want to loop it over them & get the weather for each 1 and add it to the list that will eventually"
be passed to the template. This will just be a variation which is of what we did in the first case. Other difference is we want to
looping and appending each dictionary to that list. We’ll remove the original city variable in place of a city variable in the loop:
the_weather/weather/views.py
def index(request):
...
weather_data = []
""
for city in cities:
""
city_weather = requests.get(url.format(city)).json()
""
weather = {
"'city' : city,"
"'temperature' : city_weather['main']['temp'],"
"'description' : city_weather['weather'][0]['description'],"
'icon' : city_weather['weather'][0]['icon']
}
""
weather_data.append(weather)
context = {'weather_data' : weather_data}
...
""
Now let’s update the context for to pass this list instead of the single dictionary.
